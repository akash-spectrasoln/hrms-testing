{% load static %}

{% block header %}
        <header id="page-topbar">
            <div class="navbar-header">
                <div class="d-flex">
                    <!-- LOGO -->
                    <div class="navbar-brand-box">
                        <a href="{%url 'emp_dashboard'%}" class="logo logo-dark">
                            <span class="logo-sm">

                                 <img src="{% static 'tool/scorpiq_design.png' %}" alt="" height="30">
                            </span>
                            <span class="logo-lg">
                                <img src="{% static 'tool/scorpiq_logo.png' %}" alt="" height="40">
                            </span>
                        </a>

                        <a href="{%url 'emp_dashboard'%}" class="logo logo-light">
                            <span class="logo-sm">

                                 <img src="{% static 'tool/scorpiq_design.png' %}" alt="" height="30">
                            </span>
                            <span class="logo-lg">

                                <img src="{% static 'tool/scorpiq_logo.png' %}" alt="" height="40">
                            </span>
                        </a>
                    </div>


                </div>

                <div class="d-flex">


                    <div class="dropdown d-inline-block">
                        <button type="button" class="btn header-item bg-soft-light border-start border-end" id="page-header-user-dropdown"
                        data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <img class="rounded-circle header-profile-user"src="{% if user.profile_image_url %}{{ user.profile_image_url }}{% else %}{% static 'images/users/avatar-1.jpg' %}{% endif %}"
                                alt="">
                            <span class="d-none d-xl-inline-block ms-1 fw-medium">{{user.emp_fname}}</span>
                            <i class="mdi mdi-chevron-down d-none d-xl-inline-block"></i>
                        </button>
                        <div class="dropdown-menu dropdown-menu-end">
                            <!-- item-->
                            <a class="dropdown-item" href="{% url 'set_from_devices' employee.id %}"><i class="mdi mdi-face-profile font-size-16 align-middle me-1"></i> Profile</a>

                            <a class="dropdown-item" href="{%url 'emp_logout'%}"><i class="mdi mdi-logout font-size-16 align-middle me-1"></i> Logout</a>

                        </div>
                    </div>

                    {% if messages %}
                        <div class="toast-container position-fixed top-0 end-0 p-3 " style="z-index: 9996; margin-top: 5rem;">
                            <div class="toast mb-2 position-relative" style="background-color: rgb(122, 176, 201);" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false">
                                <!-- Close button positioned at top right -->
                                <button type="button" class="btn-close btn-close-white position-absolute top-0 end-0 mt-2 me-2" data-bs-dismiss="toast" aria-label="Close"></button>

                                <div class="d-flex align-items-center text-white border-0">
                                    <div class="toast-body">
                                        <ul class="mb-1">
                                            {% for message in messages %}
                                                <li>{{ message }}</li>
                                            {% endfor %}
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endif %}








                    <script>
                        // messages
                        document.addEventListener('DOMContentLoaded', function () {
                            var toastElements = document.querySelectorAll('.toast');
                            toastElements.forEach(function (toastElement) {
                                var toast = new bootstrap.Toast(toastElement, { autohide: true, delay: 10000 });
                                toast.show();
                            });

                            // Debug: Log messages to console
                            var messages = JSON.parse(document.getElementById('toastsContainer').dataset.messages);
                            console.log('Received messages:', messages);
                        });
                    </script>
                     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
    $('#mode-setting-btn').click(function() {
        // Show the loading spinner
        $('#loading-spinner').show();

        // Send an AJAX request to toggle the dark mode in the database
        $.ajax({
            url: "",
            type: 'POST',
            headers: {'X-CSRFToken': '{{ csrf_token }}'},  // Required for POST requests
            success: function(data) {
                // Update the UI based on the response
                if (data.is_dark_mode) {
                    // Switch to dark mode in the UI
                    $('html').attr('data-bs-theme', 'dark');
                    $('body').attr('data-sidebar', 'dark');
                    $('.layout-mode-dark').show();
                    $('.layout-mode-light').hide();
                } else {
                    // Switch to light mode in the UI
                    $('html').attr('data-bs-theme', 'light');
                    $('body').attr('data-sidebar', 'light');
                    $('.layout-mode-dark').hide();
                    $('.layout-mode-light').show();
                }
            },
            error: function() {
                alert("Failed to toggle dark mode.");
            },
            complete: function() {
                // Hide the loading spinner after the request completes
                $('#loading-spinner').hide();
            }
        });
    });
</script>


                </div>
            </div>
        </header>
{% endblock header %}