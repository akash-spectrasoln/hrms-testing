<div class="calendar-wrapper" data-joining-date="{{ employee.enc_valid_from|date:'Y-m-d' }}">

    <div class="card shadow-sm mb-1">

  <!-- Calendar Header with Proper Navigation -->
  <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center py-1 flex-wrap flex-sm-nowrap">

    <!-- Previous Year -->
    <a class="btn btn-sm btn-light px-1 px-sm-2 py-0 calendar-nav" data-month="{{ month }}"
      data-year="{{ year|add:'-1' }}" {% if prev_disabled %} disabled {% endif %}>
      &laquo; <span class="d-none d-sm-inline">{{ year|add:'-1' }}</span>
    </a>

    <!-- Previous Month -->
    <a class="btn btn-sm btn-light px-1 px-sm-2 py-0 calendar-nav" data-month="{{ prev_month }}"
      data-year="{{ prev_year }}" {% if prev_disabled %} disabled {% endif %}>
      &laquo;
      <span class="d-inline d-sm-none">{{ prev_month_name|slice:":3" }}</span>
      <span class="d-none d-sm-inline">{{ prev_month_name }}</span>
    </a>

    <!-- Current Month & Year -->
    <h6 class="mb-0 text-center flex-grow-1 small">
      <span class="d-inline d-sm-none">{{ current_month_name|slice:":3" }} {{ year }}</span>
      <span class="d-none d-sm-inline">{{ current_month_name }} {{ year }}</span>
    </h6>

    <!-- Next Month -->
    <a class="btn btn-sm btn-light px-1 px-sm-2 py-0 calendar-nav" data-month="{{ next_month }}"
      data-year="{{ next_year }}" {% if next_disabled %} disabled {% endif %}>
      <span class="d-inline d-sm-none">{{ next_month_name|slice:":3" }}</span>
      <span class="d-none d-sm-inline">{{ next_month_name }}</span> &raquo;
    </a>

    <!-- Next Year -->
    <a class="btn btn-sm btn-light px-1 px-sm-2 py-0 calendar-nav" data-month="{{ month }}"
      data-year="{{ year|add:'1' }}" {% if next_year_disabled %} disabled {% endif %}>
      <span class="d-none d-sm-inline">{{ year|add:'1' }}</span> &raquo;
    </a>

    <!-- Legend Button -->
    <button id="legend-btn" class="btn btn-sm btn-light px-1 py-0 ms-1" title="Legend">
      &#9776;
    </button>
  </div>

  <div class="card-body p-1">
    <!-- Calendar Grid -->
    <div class="calendar-container mb-1">
      <!-- Week Headers -->
      <div class="calendar-grid calendar-header mb-1 small fw-bold">
        {% for day in weekdays %}
        <div class="text-center border-bottom">{{ day }}</div>
        {% endfor %}
      </div>

      <div class="calendar-grid calendar-days">
        {% for week in calendar_data %}
          {% for day in week %}
            {% if day %}
              <div
                class="calendar-day {{ day.status }} {% if day.is_today %}today-outline{% endif %} {% if day.is_disabled %}disabled{% endif %}"
                data-date="{{ day.date|date:'Y-m-d' }}" {% if day.holiday_name %}data-holiday="{{ day.holiday_name }}"
                title="{{ day.holiday_name }}" {% endif %}>
                <span class="day-number">{{ day.day }}</span>
                {% if day.total_hours  %}
                  <span class="day-hours {% if day.is_approved %}approved-hours{% endif %}">
                    {{ day.total_hours }}h
                  </span>
                {% endif %}
              </div>
            {% else %}
              <div class="calendar-day empty"></div>
            {% endif %}
          {% endfor %}
        {% endfor %}
      </div>
    </div>

    <!-- Legend -->
    <div id="legend-popup" class="legend-popup shadow-sm">
      <div class="legend-item"><span class="badge bg-success">Entered</span></div>
      <div class="legend-item"><span class="badge bg-warning text-dark">Not Entered</span></div>
      <div class="legend-item"><span class="badge" style="background-color:#f5c6cb; color:#dc3545;">Holiday</span></div>
      <div class="legend-item"><span class="badge" style="background-color:#d6c8f4; color:#6f42c1;">Leave</span></div>
      <div class="legend-item"><span class="badge bg-secondary">Weekend</span></div>
      <div class="legend-item"><span class="badge border border-primary text-dark">Today</span></div>
      <div class="legend-item"><span class="badge bg-info text-dark">Selected</span></div>
    </div>
  </div>

</div>


</div>
